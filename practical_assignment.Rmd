---
title: "Regression"
author: "Anders Christensen, Anna Damkj√¶r Laksafoss and Stefan Bruhn Rasmussen"
date: "February 21, 2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(eval = FALSE)
```


```{r read_data, include=FALSE}
fullrun <- TRUE
if (fullrun) {
  narwhal <- readRDS("outputs/narwhal.RDS")
} else {
  narwhal <- readRDS("outputs/narwhal_reduced.RDS")
}
```



In this report we will attempt to understand if the whales are affected by the presence of the seismic ship. We will be considering the following valiables as measures of the whales behaviour

* `Depth`: Depth of the whale in meters belows sea level
* `Call`: Whether a whale makes a call
* `Click`: Wheter a whale makes a click
* `Buzz`: Whether a whale makes a buzz
* `ODBA`: Overall dynamic body acceleration
* `VeDBA`: Vector dynamic body acceleration
* `Strokerate`: Strokrate of tail of the whale

## Data clean up
Before we can analyse the data we must clean up the data. From the description of the data in the problem description we can make the following initial changes:

* Combine `Date` and `Hour` to a new single time object called `Datetime`.
* Correct for positve `Depths` by substracting maximum value from all values
* Encode -1 as NA for those variables, where it applies



*Handeling NA's*: The data set contains 1.058.507 data lines of which 780.853 data lines has missing values. The variables with missing values are `Dist.to.Paamiut`, `Dist.to.shore`, `ODBA`, `VeDBA`, `Lat`, `Long` and `Strokerate`. To handle the missing values we do the following:

* `Dist.to.Paamiut`: 770.877 missing values. 
* `Dist.to.shore`: 30.009 missing values
* `ODBA` and `VeDBA`: 7 missing values
* `Lat` and `Long`: 10.882 missing values
* `Strokerate`: 693 missing values.



*Adding new valiables*: To better understand our research question we have created some new variables
**ADD A DESCRIPTION OF WHY THIS NEW VARIABLE IS BETTER**

* `BothWhales` binary, encodes when both we have data on both whales at the current timepoint

*Removing variables and observarions*: We can remove variables from the data, as some variables describe the same phenomena. 

* `ODBA` and `VeDBA` both describe the body acceleration of the whales and the two variables are extremly correlated with a correlation coefficient of 0.995. We remove the variable `VeDBA` from the data set.
* `Call`, `Buzz`, `Click` ------ **WILL WE BE REMOVING THESE**

Lastly there are 8 duplicate data lines. These 8 line have been removed. **WHICH LINES ARE THESE**.



## Exploratory analysis
```{r summaries}
summary(narwhal[,c(3:19)])
table(narwhal[,c("Ind","Phase")])
```

### Plot af numeriske variable

![](figs/numerical_densities.png)

Vi ser at

* Strokerate er "hakket" fordi det kun er integers

![](figs/depthtimeplot.png)
![](figs/locationplot.png)

### Ideas/Thoughts

* Make a binary *Phase* variable with level *T* and *I*
* Partion binary variables (such as *Calls*) into intervals (e.g. 30 second intervals around each call)
* Make A binary *Diving* variable by partioning the Depth variable.
* Pay attention to *Data leakage* (When you predict something using data which is not availiable at prediction time.)
* Make correlation plot
* Area is likely just a Long and Lat with broader categories
* Should we use both whales? Given that one of the appears only in some trials 